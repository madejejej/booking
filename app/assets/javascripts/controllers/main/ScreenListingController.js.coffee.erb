@controllers.controller( 'ScreenListingController',['$scope', '$routeParams', '$modal', 'ScreenService',  ($scope, $routeParams, $modal, ScreenService) ->

    $scope.cinemaId = $routeParams.cinema_id
    $scope.screens = ScreenService.getCinemaScreens($scope.cinemaId)

    $scope.openAddScreenDialog = () ->
        modalInstance = $modal.open(
            templateUrl: '<%= asset_path("cinemas/screens/dialogs/screenDialog.html") %>',
            controller: 'AddScreenDialogController'
            resolve:
                cinemaId: () ->
                    $scope.cinemaId
        ).result.then((result) ->
            if result is undefined then return false
            $scope.screens.push(result)
        )

    $scope.openRemoveScreenDialog = (screen) ->
        modalInstance = $modal.open(
            templateUrl: '<%= asset_path("cinemas/screens/dialogs/removeScreenDialog.html") %>',
            controller: 'RemoveScreenDialogController'
            resolve:
                cinemaId: () ->
                    $scope.cinemaId
                screen: () ->
                    screen
        ).result.then((result) ->
            if result is undefined then return false
            $scope.screens = $.grep($scope.screens, (e) ->
                return e.id != result.id;
            )
        )






])
